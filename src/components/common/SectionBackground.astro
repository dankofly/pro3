---
import { getImage } from 'astro:assets';
import type { ImageMetadata } from 'astro';

export interface Props {
  src: ImageMetadata;
  alt?: string;
  quality?: number;
  overlay?: boolean;
  loading?: 'lazy' | 'eager';
}

const {
  src,
  alt = '',
  quality = 80,
  overlay = true,
  loading = 'lazy',
} = Astro.props;

const optimized = await getImage({
  src,
  width: 1920,
  format: 'webp',
  quality,
});
---

<div class="absolute inset-0 -z-10 overflow-hidden">
  <img
    src={optimized.src}
    width={optimized.attributes.width}
    height={optimized.attributes.height}
    alt={alt}
    class="w-full h-full object-cover"
    loading={loading}
    decoding="async"
  />
  {overlay && (
    <div class="absolute inset-0 bg-gradient-to-b from-white/60 via-white/50 to-white/70 dark:from-[#060a18]/70 dark:via-[#0a0f1a]/55 dark:to-[#0f1629]/75" />
  )}
</div>
